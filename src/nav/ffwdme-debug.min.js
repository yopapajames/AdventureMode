/**
 * ffwdme.js - Turn by turn navigation in the browser.
 * @version v0.4.1
 * @copyright Copyright (c) 2011-2015 Christian BÃ¤uerlein, Silvia Hundegger; 2012-2015 flinc GmbH
 * @license MIT
 */
!function t(e,o,n){function i(s,a){if(!o[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=o[s]={exports:{}};e[s][0].call(d.exports,function(t){var o=e[s][1][t];return i(o?o:t)},d,d.exports,t,e,o,n)}return o[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,o){var n=ffwdme.components.Base.extend({constructor:function(t){this.base(t),this.bindAll(this,"navigationOnRoute","onGeopositionUpdate","navigationOffRoute","watchHtml5Position"),ffwdme.on("navigation:onroute",this.navigationOnRoute),ffwdme.on("navigation:offroute",this.navigationOffRoute),ffwdme.on("geoposition:update",this.onGeopositionUpdate),navigator.geolocation.watchPosition(this.watchHtml5Position,this.errorWatchHtml5Position),this.render()},classes:"ffwdme-widget-container ffwdme-grid-w8 ffwdme-grid-h5",html5GeoUpdateCounter:0,ffwdmeGeoUpdateCounter:0,ffwdmeOnRouteCounter:0,ffwdmeOffRouteCounter:0,currentAccuracy:0,currentHeading:0,errorWatchHtml5Position:function(){},watchHtml5Position:function(t){this.html5GeoUpdateCounter+=1,this.label(".ffwdme-components-html5GeoUpdateCounter",this.html5GeoUpdateCounter)},navigationOnRoute:function(t){this.ffwdmeOnRouteCounter+=1,this.label(".ffwdme-components-ffwdmeOnRouteCounter",this.ffwdmeOnRouteCounter)},navigationOffRoute:function(t){this.ffwdmeOffRouteCounter+=1,this.label(".ffwdme-components-ffwdmeOffRouteCounter",this.ffwdmeOffRouteCounter)},onGeopositionUpdate:function(t){this.ffwdmeGeoUpdateCounter+=1,heading=t.geoposition.coords.heading,heading&&(this.currentHeading=Number(heading.toFixed(2))),accuracy=t.geoposition.coords.accuracy,accuracy&&(this.currentAccuracy=Number(accuracy.toFixed(2))),this.label(".ffwdme-components-ffwdmeGeoUpdateCounter",this.ffwdmeGeoUpdateCounter),this.label(".ffwdme-components-currentAccuracy",this.currentAccuracy),this.label(".ffwdme-components-currentHeading",this.currentHeading)},make:function(){this.base();var t=['<div class="ffwdme-components-geolocation-debug ffwdme-components-label-small">','<div>Html5 geo update: <span class="ffwdme-components-html5GeoUpdateCounter">-</span></div>','<div>ffwdme geo update: <span class="ffwdme-components-ffwdmeGeoUpdateCounter">-</span></div>','<div>Accuracy: <span class="ffwdme-components-currentAccuracy">-</span></div>','<div>Heading: <span class="ffwdme-components-currentHeading">-</span></div>','<div>On Route: <span class="ffwdme-components-ffwdmeOnRouteCounter">-</span></div>','<div>Off Route: <span class="ffwdme-components-ffwdmeOffRouteCounter">-</span></div>',"</div>"].join("");return $(this.el).addClass("ffwdme-components-container").html(t),this},label:function(t,e){return this.accessor(t,e)},accessor:function(t,e){var o=this.$(t);return"undefined"==typeof e?o.html():(o.html(e),o)}});e.exports=n},{}],2:[function(t,e,o){var n=ffwdme.components.Base.extend({constructor:function(t){this.base(t);for(var e=0;e<this.nodeIds.length;e++)this.nodes[this.nodeIds[e]]=$("#"+this.nodeIds[e]);this.nodes.ratioCompletedDirectionProgress=$("#ratio-completed-direction-progress"),this.nodes.ratioCompletedRouteProgress=$("#ratio-completed-route-progress"),$("#nav-info-trigger").click(function(){$("#nav-info").toggleClass("hidden"),$("#routing").addClass("hidden")}),this.bindAll(this,"navigationOnRoute","navigationOffRoute"),ffwdme.on("navigation:onroute",this.navigationOnRoute),ffwdme.on("navigation:offroute",this.navigationOffRoute)},nodes:{},nodeIds:["street","turnAngle","distanceToNextDirection","distanceToDestination","timeToDestination","timeToNextDirection","ratioCompletedDirection","ratioCompletedRoute"],navigationOnRoute:function(t){var e;t.navInfo.position;try{for(var o=0;o<this.nodeIds.length;o++)e=this.nodeIds[o],this.nodes[e].html(t.navInfo.nextDirection[e]||t.navInfo[e]);this.nodes.ratioCompletedDirectionProgress.css("width",100*t.navInfo.ratioCompletedDirection+"%"),this.nodes.ratioCompletedRouteProgress.css("width",100*t.navInfo.ratioCompletedRoute+"%")}catch(t){console.warn("Error while updating the nodes"),console.dir(t)}},navigationOffRoute:function(t){console.warn(ffwdme.navigation.routePointCounter+": NO NEAREST POINT # "+ffwdme.navigation.offRouteCounter+" -> distance: "+t.navInfo.nearest.distance+" m")}});e.exports=n},{}],3:[function(t,e,o){var n=ffwdme.components.Base.extend({constructor:function(t){this.base(t),this.bindAll(this,"start","error","success","calculateRouteByForm","fetchCombination"),$("#load-combination").click(this.fetchCombination),$("#calc-route-by-form").click(this.calculateRouteByForm);var e=this;$("#player-start").click(function(){e.player.start()}),$("#player-pause").click(function(){e.player.pause()}),$("#player-reset").click(function(){e.player.reset()}),$("#routing-trigger").click(function(){$("#routing").toggleClass("hidden"),$("#nav-info").addClass("hidden")}),ffwdme.on("routecalculation:start",this.start),ffwdme.on("routecalculation:error",this.error),ffwdme.on("routecalculation:success",this.success)},player:null,start:function(t){console.info("routing started")},error:function(t){console.error("routing FAILED")},success:function(t){console.info("routing SUCCESSFULL!"),console.dir(t),ffwdme.navigation.setRoute(t.route).start()},fetchCombination:function(){var t=$("#select-combination").val().split(";"),e=t[0];$("#custom-route-start-lat").val(t[1]),$("#custom-route-start-lng").val(t[2]),$("#custom-route-dest-lat").val(t[3]),$("#custom-route-dest-lng").val(t[4]);try{this.player=new ffwdme.debug.geoprovider.PlayerLocal({id:e}),$("#geoprovider-track").text(e)}catch(o){$("#geoprovider-track").text("Could not fetch the recorded track!: "+e)}},calculateRouteByForm:function(){var t=document.getElementById("custom-route-start-lat").value,e=document.getElementById("custom-route-start-lng").value,o=document.getElementById("custom-route-dest-lat").value,n=document.getElementById("custom-route-dest-lng").value;new ffwdme.routingService({start:{lat:t,lng:e},dest:{lat:o,lng:n}}).fetch()}});e.exports=n},{}],4:[function(t,e,o){var n=ffwdme.Class.extend({constructor:function(t){},track:null,currentIndex:null,currentPoint:null,watchId:null,load:function(){},loop:function(){this.currentPoint=this.track.points[this.currentIndex];var t=this.track.points[this.currentIndex+1];if(this.currentPoint&&t){var e=t.timestampRelative-this.currentPoint.timestampRelative,o={geoposition:this.currentPoint,point:new ffwdme.LatLng(this.currentPoint.coords.latitude,this.currentPoint.coords.longitude)};ffwdme.geolocation.last=o,ffwdme.trigger("geoposition:update",o),this.watchId=setTimeout(this.bind(this.loop,this),e),this.currentIndex++}},start:function(){null===this.currentIndex&&(this.currentIndex=0),this.loop()},pause:function(){clearTimeout(this.watchId)},reset:function(){this.currentIndex=0},stop:function(){this.pause(),this.reset()},getCurrentPosition:function(t,e,o){},watchPosition:function(t,e,o){},clearWatch:function(t){}});e.exports=n},{}],5:[function(t,e,o){var n=t("./player"),i=t("./track"),r=n.extend({constructor:function(t){this.base(t),this.id=t.id,this.load()},BASE_URL:"/recorded_routes/",id:null,load:function(){var t=this.BASE_URL+this.id+".json",e=this;$.getJSON(t,function(t){e.track=new i,e.track.points=t.track.points})}});e.exports=r},{"./player":4,"./track":7}],6:[function(t,e,o){var n=t("./track"),i=ffwdme.Class.extend({constructor:function(){},track:null,recording:!1,onUpdate:function(t){this.track.add(t.geoposition)},start:function(){return this.track=new n,this.onUpdate=this.bind(this.onUpdate,this),ffwdme.on("geoposition:update",this.onUpdate),this.recording=!0,this},stop:function(){return ffwdme.off("geoposition:update",this.onUpdate),this.recording=!1,this},save:function(){}});e.exports=i},{"./track":7}],7:[function(t,e,o){var n=ffwdme.Class.extend({constructor:function(){this.points=[]},points:null,startTime:null,add:function(t){this.points.length||(this.startTime=t.timestamp);for(var e=n.locationAttributes,o={coords:{},timestamp:t.timestamp,timestampRelative:t.timestamp-this.startTime},i=0,r=e.length;i<r;i++)try{o.coords[e[i]]=t.coords[e[i]]}catch(s){console.info("error while working with: "+e[i])}return this.points.push(o),this},toJSON:function(){var t={track:{points:this.points}};return JSON.stringify(t)},parseJSON:function(t){if(t){var e=JSON.parse(t);this.points=e.track.points}}},{locationAttributes:["latitude","longitude","altitude","accuracy","altitudeAccuracy","heading","speed"]});e.exports=n},{}],8:[function(t,e,o){var n=t("./geoprovider/player_local"),i=t("./geoprovider/recorder"),r=t("./components/geolocation"),s=t("./components/nav_info"),a=t("./components/routing");!function(t){t.debug={geoprovider:{PlayerLocal:n,Recorder:i},components:{Geolocation:r,NavInfo:s,Routing:a}}}(ffwdme)},{"./components/geolocation":1,"./components/nav_info":2,"./components/routing":3,"./geoprovider/player_local":5,"./geoprovider/recorder":6}]},{},[8]);